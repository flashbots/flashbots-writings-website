<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/rss.xml" title="Flashbots Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="Flashbots Blog Atom Feed">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous"><title data-react-helmet="true">The Cost of Resilience | Flashbots</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://writings.flashbots.net/the-cost-of-resilience"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><meta data-react-helmet="true" property="og:title" content="The Cost of Resilience | Flashbots"><meta data-react-helmet="true" name="description" content="A new mev-boost feature allows validators to maximize Ethereumâ€™s censorship resistance by building low-MEV blocks locally while still outsourcing the building of high-MEV blocks."><meta data-react-helmet="true" property="og:description" content="A new mev-boost feature allows validators to maximize Ethereumâ€™s censorship resistance by building low-MEV blocks locally while still outsourcing the building of high-MEV blocks."><meta data-react-helmet="true" property="og:image" content="https://writings.flashbots.net/img/savana.jpg"><meta data-react-helmet="true" name="twitter:image" content="https://writings.flashbots.net/img/savana.jpg"><meta data-react-helmet="true" property="og:type" content="article"><meta data-react-helmet="true" property="article:published_time" content="2022-11-22T00:00:00.000Z"><meta data-react-helmet="true" property="article:author" content="https://twitter.com/elenahoolu,https://twitter.com/fiiiu_,https://twitter.com/hasufl"><meta data-react-helmet="true" property="article:tag" content="mev-boost,data,research"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://writings.flashbots.net/the-cost-of-resilience"><link data-react-helmet="true" rel="alternate" href="https://writings.flashbots.net/the-cost-of-resilience" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://writings.flashbots.net/the-cost-of-resilience" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.1b11a3d0.css">
<link rel="preload" href="/assets/js/runtime~main.181b1a6f.js" as="script">
<link rel="preload" href="/assets/js/main.15395b8e.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navRoot_1Vd8 navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items fixFlex_19nV"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" target="_self" href="/"><svg width="12" height="14" viewBox="0 0 12 14"><path fill-rule="evenodd" clip-rule="evenodd" d="M7.07289 0L7.91879 0.483459L6.631 4.76674H11.5178L4.19989 12.679L3.35398 12.1956L4.72089 7.64736H0L7.07289 0ZM5.20514 6.03608L6.33835 2.26697L2.28701 6.64736H5.02136L5.20514 6.03608ZM4.93407 10.4124L9.23077 5.76674H6.33078L6.16271 6.3243L4.93407 10.4124Z" fill="var(--ifm-font-color-base)"></path></svg><span class="navbar__title title_2fsg logoTitle_2plQ">Flashbots</span></a></div><div class="navbar__items navbar__items--right fixFlex_19nV navItems_l2fJ"><a href="https://flashbots.net" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>About</span></a><a href="https://boost.flashbots.net/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>MEV-Boost</span></a><a href="https://collective.flashbots.net/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Forum</span></a><a href="https://jobs.flashbots.net/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Join us</span></a><div class="react-toggle toggle_268h react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page layoutDefaults_1s0t"><div class="container margin-vert--md containerRoot_3RmU"><div class="row"><main class="col col--12" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_nmLu" itemprop="headline">The Cost of Resilience</h1><div class="blogPostData_3WzT margin-vert--md"><time datetime="2022-11-22T00:00:00.000Z" itemprop="datePublished">22.11.22</time> Â· 8 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_HqTB"><div class="avatar margin-bottom--sm"><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://twitter.com/elenahoolu" target="_blank" rel="noopener noreferrer" class="fixedColor_3yYP" itemprop="url"><span itemprop="name">Elaine Hu</span></a></div></div></div></div><div class="col col--6 authorCol_HqTB"><div class="avatar margin-bottom--sm"><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://twitter.com/fiiiu_" target="_blank" rel="noopener noreferrer" class="fixedColor_3yYP" itemprop="url"><span itemprop="name">Alejo Salles</span></a></div></div></div></div><div class="col col--6 authorCol_HqTB"><div class="avatar margin-bottom--sm"><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://twitter.com/hasufl" target="_blank" rel="noopener noreferrer" class="fixedColor_3yYP" itemprop="url"><span itemprop="name">Hasu</span></a></div></div></div></div></div></header><meta itemprop="image" content="https://writings.flashbots.net/img/savana.jpg"><div class="markdown" itemprop="articleBody"><p><em>tl;dr</em></p><ul><li>A new mev-boost feature allows validators to maximize Ethereumâ€™s censorship resistance by building low-MEV blocks locally while still outsourcing the building of high-MEV blocks.</li><li>Using this feature carries an opportunity costâ€”the price of resilience.</li><li>As most blocks are actually low-MEV, however, forfeiting a little profit goes a long way in increasing resilience!</li><li>This is a breakthrough in the tradeoff between maximizing MEV extraction and maximizing censorship resistance.</li></ul><header><h1>Network Resilience</h1></header><p>Flashbots has recently become a target of public scrutiny after OFAC broadened the set of sanctioned addresses to include smart contracts for the first time, affecting many users of the Ethereum network. While Flashbots has tried to navigate both the risk and ambiguity around the application of OFAC sanctions to data and communications infrastructure in web3 since the beginning, this was less fraught before the merge, when relays were sending bundles to mining pools, who were then responsible of assembling full blocks locally. The market moving to full block submission established the full separation between block builders and validators, who can no longer add individual transactions to a block.</p><p>Today, <a href="https://www.mevwatch.info/" target="_blank" rel="noopener noreferrer">most blocks in Ethereum are OFAC compatible</a>, and although in practice this means that offending transactions only get <a href="https://www.inclusion.watch/" target="_blank" rel="noopener noreferrer">throttled by a small amount</a>, ensuring robust decentralization and resilience at the protocol level is critical for Ethereum&#x27;s success as neutral infrastructure. Unfortunately, changes to mev-boost alone do not suffice to provide these guarantees. In order for consensus clients to profit-switch between blocks coming from a (potentially selective) market of builders and the local mempool, deep changes to both the Execution and Consensus Clients need to take place. While the community is in agreement that this is an important issue, client teams have different priorities they need to balance. Other long-term proposals like Inclusion Lists and Partial Block Auctions are part of the core <a href="https://barnabe.substack.com/p/pbs" target="_blank" rel="noopener noreferrer">Proposer-Builder Separation research track</a>.</p><p>The question then arises of what can we do to address the issue today, while deferring a robust, protocol-level solution. It has been suggested that Flashbots self-limits their share of relayed blocks, but we ultimately believe that market distortions like this won&#x27;t achieve much, as we cannot really predict how other relays will behave. Flashbots charging a small fee was also proposed, as establishing this standard would encourage other entities to run independent relays. While this seems like a sensible proposal, it risks entrenching the relay role, which we only view as a temporary solution until SUAVE is deployedâ€”a fully trustless building network.</p><p>Fortunately, other builders and relays have started to emerge and take increasingly larger shares of the market, and we are actively providing support to teams interested in running other relays. As of last week, we have <a href="https://writings.flashbots.net/open-sourcing-the-flashbots-builder" target="_blank" rel="noopener noreferrer">open sourced our builder</a>, so anyone can now easily run a builder too. From the validatorsâ€™ perspective, however, the question remains: run mev-boost and comply with the regulations that their trusted relays adopt, or build blocks only locally, potentially forfeiting 100+ ETH profit opportunities?</p><header><h1>The Solution</h1></header><p>Now, validators can sidestep this question by running mev-boost with the <a href="https://github.com/flashbots/mev-boost#mev-boost-cli-arguments" target="_blank" rel="noopener noreferrer">new</a> <code>min-bid</code> <a href="https://github.com/flashbots/mev-boost#mev-boost-cli-arguments" target="_blank" rel="noopener noreferrer">parameter</a>. What this parameter does is only accept blocks from relays if they bid above a chosen value, otherwise a locally-built block is proposed. This leverages the fact that the profit increase coming from mev-boost is not that large for most blocks. Validators can thus forfeit a small amount of profit in exchange for making the network more resilient, while keeping the door open for high-MEV opportunities.</p><p><img alt="resilience_1.png" src="/assets/images/resilience_1-2d1b8dc677fd7b0a8a53521c348a8483.png"></p><p>As depicted, the new <code>min-bid</code> parameter allows validators to escape the tradeoff between profit maximization and network resilience. In what follows, we explore the cost that validators incur by opting into this feature.</p><header><h1>Block Profit Distribution</h1></header><p>We start by looking at the cumulative distribution of block profits, for both blocks coming from the Flashbots relay, and locally built blocks, all data post-merge<sup id="fnref-1"><a href="#fn-1" class="footnote-ref">1</a></sup>:</p><p><img alt="resilience_2.png" src="/assets/images/resilience_2-a6778ae1547423a969a936e0ff9257eb.png"></p><p>As expected, the mev-boost distribution has a longer tail. We can look at the data in a different way by displaying the profit difference between both kinds of blocks, as follows:</p><p><img alt="resilience_3.png" src="/assets/images/resilience_3-852226907a34c16b9ea96d91d23fa809.png"></p><p>The asymmetry in this distribution again shows us how mev-boost blocks are generally more valuable than mempool blocks. However, we also see that a sizeable amount of blocks lie close to having no difference in value. Looking at the profit bucket of 0.05 ETH as an example, historically 35% of the mev-boost blocks have a profit of or below 0.05 ETH. By setting the minimum bid value to 0.05 ETH, the proposer will choose to build local blocks approximately a third of the time.</p><p>The question now is how much profit would validators be forfeiting by choosing to set a positive value for the <code>min-bid</code> parameter.</p><header><h1>Opportunity Cost</h1></header><p>The opportunity cost of setting a minimum bid value is the cumulative difference in block profit between blocks using Flashbots mev-boost relay and blocks built locally. The larger the minimum bid, the more blocks will be locally built, and the larger the opportunity cost:</p><p><img alt="resilience_4.jpg" src="/assets/images/resilience_4-a7023051d042f4f9bbbf7c9a7a04d2a2.png"></p><p>As we see from the graph, the opportunity cost can get quite high for large values of the <code>min-bid</code> parameter, which means that most blocks would be built locally. However, as we pointed out, we are mostly concerned with low-profit blocks, which can get us a long way towards network resilience. Looking at only block profits below 0.11 ETH, which account for ~73% of all mev-boost blocks, we see the following opportunity cost, together with the implied approximate APR for each setting of the parameter:</p><p><img alt="resilience_5.png" src="/assets/images/resilience_5-70bc04cd7d7852245bd06745c05034fc.png"></p><p>We see again how the opportunity cost increases with the value of <code>min-bid</code>, but at the same time the projected APR falls only very slowly. This leads to the question of whether forfeiting a small amount of profit can make a difference in terms of transaction inclusion, which we look at next.</p><header><h1>Effects on Transaction Inclusion</h1></header><p>Around <a href="https://www.inclusion.watch/" target="_blank" rel="noopener noreferrer">72% of Ethereum blocks</a> are now built in an OFAC-compatible way. This means that some transactions experience delays in getting included on chain. In particular, the probability of one of these transactions to be included after one block is around 28%, corresponding to the validators who either build blocks locally or get profitable blocks from non-OFAC compatible relays. If all validators were using mev-boost and connecting only to OFAC-compatible relays, the inclusion rate would of course fall down to 0.</p><p>Let&#x27;s look at the inclusion rate of these transactions for different values of <code>min-bid</code>, focusing only on mev-boost instances connected to OFAC-compatible relays:</p><p><img alt="resilience_6.png" src="/assets/images/resilience_6-b6846cacaf7382c17123d7588712192f.png"></p><p>As mentioned, the default value of 0 would prevent any transaction from being included. For relatively small values of <code>min-bid</code>, however, we see how non-OFAC compatible transactions have a large chance of inclusion even after very few blocks. As an example, setting a value of <code>min-bid</code> of 0.05 ETH would bring the inclusion probability after one block from 0 to 35%. Clearly, a majority of validators opting into this feature would go a long way towards increasing the network&#x27;s resilience.</p><p>The following table summarizes our results for different values of the <code>min-bid</code> parameter:</p><table><thead><tr><th>Minimum bid value</th><th>0 ETH</th><th>0.02 ETH</th><th>0.05 ETH</th><th>0.10 ETH</th><th>0.24 ETH</th></tr></thead><tbody><tr><td>Cumulative % of blocks â‰¤ min bid value</td><td>n.a.</td><td>5%</td><td>35%</td><td>70%</td><td>90%</td></tr><tr><td>Opportunity cost per block</td><td>0 ETH</td><td>0.003 ETH</td><td>0.007 ETH</td><td>0.01 ETH</td><td>0.01 ETH</td></tr><tr><td>Approximate proposer APR %</td><td>6.5%</td><td>6.4%</td><td>6.3%</td><td>6.3%</td><td>6.2%</td></tr><tr><td>non-OFAC inclusion rate after 1 block</td><td>0%</td><td>5%</td><td>35%</td><td>70%</td><td>90%</td></tr></tbody></table><header><h1>Wat Do?</h1></header><p>While censorship resistance ultimately needs to be tackled at the protocol level, we can today leverage the fact that most blocks are low-profit, such that the difference in profit between local and relay-built blocks is not that large.</p><p>If you run an Ethereum validator and are willing to incur a small opportunity cost in exchange for making the network more resilient, <a href="https://github.com/flashbots/mev-boost#setting-a-minimum-bid-value-with--min-bid" target="_blank" rel="noopener noreferrer">run mev-boost with</a>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">mev-boost -min-bid &lt;x&gt; -relay ...</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>where <code>x</code> is the minimum accepted ETH-denominated profit amount from blocks coming from the relays. As we saw on the table in the previous section, setting <code>x = 0.05</code> incurs a per-block opportunity cost of 0.011 ETH, which decreases the annual return for proposer by only 0.1% in APR. This small decrease in yield has a sizeable effect in network resilience: if all validators connecting to OFAC-compatible relays adopted this threshold, the 1 block inclusion probability for non-OFAC compatible transactions would increase from the current 28% to coarsely 53%. Larger voluntary forfeitures of profit would of course entail even greater increases in network resilience.</p><p>We encourage validators to update mev-boost and help reinforce Flashbots ongoing commitment to building open and decentralized infrastructure in line with Ethereum&#x27;s goals.</p><p><em>Thank you to metachris, Kailin, and Xin for contributions to this post :)</em></p><hr><p><sup id="fnref-1"><a href="#fn-1" class="footnote-ref">1</a></sup> Two data sources are used in in this analysis: payloads delivered through the <a href="https://boost-relay.flashbots.net/" target="_blank" rel="noopener noreferrer">Flashbots MEV-Boost relay</a> and included on chain ranging from block number <code>15537940</code> to <code>15947320</code>, and the Flashbots mempool builder (<code>0xa1defa..</code>), which provides reference mempool block values.</p><p><sup id="fnref-2"><a href="#fn-2" class="footnote-ref">2</a></sup> The combined data with block value from mempool and from MEV-Boost can be downloaded from <a href="https://drive.google.com/file/d/1wvdO_DbrMu3_Ivld6IeTbGh7QsxjXluC/view" target="_blank" rel="noopener noreferrer">here</a>.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/the-future-of-mev-is-suave"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Â« The Future of MEV is SUAVE</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/open-sourcing-the-flashbots-builder"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Open sourcing the Flashbots Builder Â»</div></a></div></nav></main><div class="col col--2 TOC_1KIS"><div class="tableOfContents_rbnR thin-scrollbar"></div></div></div></div></div><footer class="footer"><div class="container"><div class="col footer__links"><div><ul class="row footer__items"><li class="footer__item"><a href="https://github.com/flashbots" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github</a></li><li class="footer__item"><a href="https://docs.flashbots.net/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Documentation</a></li><li class="footer__item"><a href="https://status.flashbots.net/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Status</a></li></ul></div><div><ul class="row footer__items"><li class="footer__item"><a href="https://calendar.flashbots.net/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Calendar</a></li><li class="footer__item"><a href="https://writings.flashbots.net/tags/transparency-report" target="_blank" rel="noopener noreferrer" class="footer__link-item">Transparency reports</a></li></ul></div><div><ul class="row footer__items"><li class="footer__item"><a href="http://discord.gg/flashbots" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UCclbTgsnYUy3vmrptIqCmqQ" target="_blank" rel="noopener noreferrer" class="footer__link-item">YouTube</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Â© 2022 Flashbots, Ltd</div></div></div></footer></div>
<script src="/assets/js/runtime~main.181b1a6f.js"></script>
<script src="/assets/js/main.15395b8e.js"></script>
</body>
</html>