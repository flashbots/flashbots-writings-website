<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/writings/rss.xml" title="Flashbots Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/writings/atom.xml" title="Flashbots Blog Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/research/rss.xml" title="Flashbots Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/research/atom.xml" title="Flashbots Blog Atom Feed">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous"><title data-react-helmet="true">Searching Post-Merge | Flashbots</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://writings.flashbots.net/writings/searching-post-merge"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><meta data-react-helmet="true" property="og:title" content="Searching Post-Merge | Flashbots"><meta data-react-helmet="true" name="description" content="If you&#x27;re a searcher on Proof of Work (PoW) Ethereum and you&#x27;re wondering how your experience will change as Ethereum switches to Proof of Stake (PoS), then this post is for you."><meta data-react-helmet="true" property="og:description" content="If you&#x27;re a searcher on Proof of Work (PoW) Ethereum and you&#x27;re wondering how your experience will change as Ethereum switches to Proof of Stake (PoS), then this post is for you."><meta data-react-helmet="true" property="og:type" content="article"><meta data-react-helmet="true" property="article:published_time" content="2022-08-25T00:00:00.000Z"><meta data-react-helmet="true" property="article:author" content="https://twitter.com/zeroXbrock"><meta data-react-helmet="true" property="article:tag" content="pos"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://writings.flashbots.net/writings/searching-post-merge"><link data-react-helmet="true" rel="alternate" href="https://writings.flashbots.net/writings/searching-post-merge" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://writings.flashbots.net/writings/searching-post-merge" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.af4bf933.css">
<link rel="preload" href="/assets/js/runtime~main.cfd8f5bd.js" as="script">
<link rel="preload" href="/assets/js/main.10a441de.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navRoot_1Vd8 navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items fixFlex_19nV"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" target="_self" href="/"><svg width="12" height="14" viewBox="0 0 12 14"><path fill-rule="evenodd" clip-rule="evenodd" d="M7.07289 0L7.91879 0.483459L6.631 4.76674H11.5178L4.19989 12.679L3.35398 12.1956L4.72089 7.64736H0L7.07289 0ZM5.20514 6.03608L6.33835 2.26697L2.28701 6.64736H5.02136L5.20514 6.03608ZM4.93407 10.4124L9.23077 5.76674H6.33078L6.16271 6.3243L4.93407 10.4124Z" fill="var(--ifm-font-color-base)"></path></svg><span class="navbar__title title_2fsg logoTitle_2plQ">Flashbots</span></a></div><div class="navbar__items navbar__items--right fixFlex_19nV navItems_l2fJ"><a href="https://flashbots.net" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>About</span></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/writings">Writings</a><a class="navbar__item navbar__link" href="/research">Research</a><div class="react-toggle toggle_268h react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page layoutDefaults_1s0t"><div class="container margin-vert--md containerRoot_3RmU"><div class="row"><main class="col col--12" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_nmLu" itemprop="headline">Searching Post-Merge</h1><div class="blogPostData_3WzT margin-vert--md"><time datetime="2022-08-25T00:00:00.000Z" itemprop="datePublished">25.08.22</time> Â· 10 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_HqTB"><div class="avatar margin-bottom--sm"><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://twitter.com/zeroXbrock" target="_blank" rel="noopener noreferrer" class="fixedColor_3yYP" itemprop="url"><span itemprop="name">Brock Smedley</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>If you&#x27;re a searcher on Proof of Work (PoW) Ethereum and you&#x27;re wondering how your experience will change as Ethereum switches to Proof of Stake (PoS), then this post is for you.</p><p>In this document I&#x27;ll explain new concepts like what proposer/builder separation (PBS), block building, and PoS validators are in simple terms. Moreover, I&#x27;ll outline how these terms relate to searching and PoW Ethereum. Finally, I&#x27;ll also address common questions related to this these topics.</p><p>This post was written as a labor of love for the searcher community. We at Flashbots are working hard so that you can be merge-ready and start searching PoS Ethereum on day one!</p><hr><ul><li><a href="#key-takeaways">Key Takeaways</a></li><li><a href="#proposerbuilder-separation-pbs">Proposer/Builder Separation (PBS)</a></li><li><a href="#bidding-for-inclusion">Bidding for Inclusion</a></li><li><a href="#how-to-choose-a-good-builder">How to Choose a Good Builder</a></li><li><a href="#what-stays-the-same">What Stays the Same</a></li><li><a href="#what-changes-for-searchers">What Changes for Searchers</a><ul><li><a href="#blockbuilding-algorithm">Blockbuilding Algorithm</a></li><li><a href="#mev-blocks-api">MEV-Blocks API</a></li><li><a href="#better-support">Better Support</a></li></ul></li><li><a href="#conclusion">Conclusion</a></li></ul><hr><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="key-takeaways"></a>Key Takeaways<a class="hash-link" href="#key-takeaways" title="Direct link to heading">#</a></h2><p>After the merge,</p><ol><li><strong>mev-boost</strong> separates what PoS validators (PoW miners) do into two roles: block building and block proposal. Searchers will send bundles to block builders, or they may be block builders themselves.</li><li>With mev-boost, searchers will need to reason about two auctions. First, searchers compete for bundle inclusion within blocks that builders are proposing. Second, builders compete for block inclusion. To be included on-chain a searcher&#x27;s bundle must win the blockspace auction for the builder they submit to, <em>and</em> the builder they submit to must win the auction amongst different builders.</li><li>Choosing a builder that is performant and can be trusted with your transactions is critical.</li><li>Existing client libraries for Flashbots are already compatible with post-merge architecture â€” <strong>no changes are needed from searchers to send bundles to Flashbots</strong>.</li><li>The Flashbots builder will use a new algorithm to produce the most profitable block. We no longer guarantee top-of-block execution and ordering with respect to effective gas prices for bundles. Rather, the algorithm optimizes for overall profit. Bundles are still included in the block atomically, but non-bundle transactions may now be included between bundles.</li><li>We rolled out <a href="mailto:searchersupport@flashbots.net" target="_blank" rel="noopener noreferrer">searchersupport@flashbots.net</a> and the <a href="https://collective.flashbots.net/c/searchers/12" target="_blank" rel="noopener noreferrer">Searcher Self-Support Group</a> forum to improve searcher support.</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="proposerbuilder-separation-pbs"></a>Proposer/Builder Separation (PBS)<a class="hash-link" href="#proposerbuilder-separation-pbs" title="Direct link to heading">#</a></h2><p>PBS splits the responsibilities of PoW miners (PoS validators) into two roles: block building and block proposal. Block builders are specialists who accept transactions from users and searchers, and try to build the most profitable block possible from those transactions. mev-boost is a trusted form of PBS implemented post-merge where builders submit blocks to a trusted entity (or entities) called relays. Relays are responsible for aggregating blocks from builders and figuring out which block is the most profitable, which is ultimately what validators sign and what is included on-chain. You can read more about relays in <a href="https://collective.flashbots.net/t/how-are-relays-defined-in-pos-ethereum/148?u=brock" target="_blank" rel="noopener noreferrer">this forum post</a>.</p><p>As a searcher on PoS Ethereum, your primary concern regarding PBS is sending your transactions/bundles to the right builder(s). Builders, and the relays they connect to, will be able to see your transactions before they&#x27;re included (which means they can front-run, censor, etc), so it&#x27;s important to choose builders that you trust.</p><p>While it doesn&#x27;t directly impact searchers, it should also be noted that <strong>mev-boost</strong> is the component that enables validators to plug into the PBS builder network. In short, it chooses the most profitable block from multiple relays. If you want to learn more about this, check out the <a href="https://boost.flashbots.net/" target="_blank" rel="noopener noreferrer">official mev-boost website</a>. It&#x27;s also worth noting that this implementation of PBS is only a stopgap for in-protocol PBS. Eventually, PBS will be built into Ethereum natively, which will eliminate the need for trusted relays.</p><p><img alt="mevboost-searcher-bundle-flow.png" src="/assets/images/mevboost-searcher-bundle-flow-bae4ba67a9d8d928efe337f36defa14a.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="bidding-for-inclusion"></a>Bidding for Inclusion<a class="hash-link" href="#bidding-for-inclusion" title="Direct link to heading">#</a></h2><p>In PoW Ethereum there is only one auction for inclusion: the blockspace auction. Searchers simply have to bid more than the other searchers vying for the same MEV opportunity, and as long as their transactions don&#x27;t get censored by the miner, and are profitable enough to the miner, they will be included.</p><p>mev-boost adds a new auction to the mix: the <strong>slot auction</strong>. Validators using mev-boost fetch the most profitable block from the relays they connect to, which means that block builders effectively bid for inclusion with the value of the block they produce. When PBS is implemented in-protocol, there will no longer be relays, so validators will pick the most profitable block directly from builders. Check out <a href="https://collective.flashbots.net/t/how-are-relays-defined-in-pos-ethereum/148?u=brock" target="_blank" rel="noopener noreferrer">this forum post</a> for more information about relays.</p><p>In essence, the <a href="https://ethereum.org/en/developers/docs/consensus-mechanisms/pos/#validators" target="_blank" rel="noopener noreferrer">slot</a> auction is a game of which builder can create the most profitable block for the validator. Builders may choose to rely only on transaction fees and MEV to constitute the value of their block, but they also have the option to send additional funds to the validator directly for a better chance of inclusion.</p><p>You may consider bidding for the slot auction <em>in addition</em> to the blockspace auction to increase the chance that your builder&#x27;s block gets included on-chain. This can be done by sending ETH directly to the address of the validator responsible for filling the target slot.</p><p>Although sending bundles to a builder with less searcher competition will reduce your chance of being outbid in the blockspace auction, choosing a good builder that accepts transactions from other searchers will generally improve your chances of inclusion. The more a block is worth (transaction fees + MEV), the more likely it is to win the slot auction and be included on-chain.</p><p>You may also consider sending your bundles to multiple builders as part of your strategy. Even if you have the most profitable <em>bundle</em> in a block, that <em>block</em> could still lose the slot auction. If you have the most profitable bundle in several builders&#x27; blocks, your odds improve. That being said, different builders will have different sources of incoming transactions and bundles, and thus different potential conflicts with your bundle. Bid accordingly.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="how-to-choose-a-good-builder"></a>How to Choose a Good Builder<a class="hash-link" href="#how-to-choose-a-good-builder" title="Direct link to heading">#</a></h2><p>There are a few criteria to look for in a block builder:</p><ul><li>Are they committed to fair and unbiased execution?<ul><li>A good builder will not front-run, sandwich or censor bundles, or otherwise engage in activities that abuse privileged data access.</li></ul></li><li>Do they connect to a trusted relay (or relays)?<ul><li>Keep in mind that the relay can also see raw transactions, which gives them the ability to front-run, censor, etc.</li></ul></li><li>Do their relays connect to enough validators?<ul><li>The more validators a relay connects to, the more slots will generally be available for builders connected to that relay. When you&#x27;re targeting a specific block/slot, it&#x27;s imperative that you send your transactions to a builder which is connected to the validator responsible for proposing a block in that slot. More validators â‡’ better inclusion rates.</li><li>Note: Any validator can <a href="https://github.com/flashbots/mev-boost#usage" target="_blank" rel="noopener noreferrer">use mev-boost to connect to the Flashbots relay and other relays</a>.</li><li>It&#x27;s also worth considering how much collective stake the validators connected to a relay have. Generally speaking, if more than one block is proposed to the network (unusual but possible), the block with the most collective stake attesting to it will be included. This scenario is explained in greater detail in the <a href="https://ethereum.org/en/developers/docs/consensus-mechanisms/pos/#fork-choice" target="_blank" rel="noopener noreferrer">Ethereum docs</a>.</li></ul></li></ul><p>Also note that block builders have the freedom to specialize. You may find that one builder is more or less friendly to your strategy than others. Builders are competing with each other, so they are all incentivized to include your bundles in their blocks, but you may find that some builders will prioritize certain strategies over others regardless of potential profits. Builders might also censor certain bundles due to local regulations or corporate strategies and policies. There are a lot of variables in play here, so I recommend trying a few trustworthy builders and seeing how your mileage varies first-hand.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="what-stays-the-same"></a>What Stays the Same<a class="hash-link" href="#what-stays-the-same" title="Direct link to heading">#</a></h2><p>Flashbots remains steadfast in our commitments to illuminate the dark forest, democratize MEV extraction, and distribute the benefits of MEV for social good, all while working in the open.</p><p>Flashbots will run a builder following the principles we&#x27;ve adhered to in PoW Ethereum: democratized access to MEV, fair &amp; reliable execution, and privacy.</p><p>The Flashbots builder hosts all the same endpoints as the PoW mev-relay API. After the merge, the original URL for mev-relay (<a href="http://relay.flashbots.net/" target="_blank" rel="noopener noreferrer">relay.flashbots.net</a>) will point to the Flashbots builder, making the transition seamless â€” you won&#x27;t have to change anything. Clients used to send, simulate, and debug bundles are already compatible with our post-merge architecture.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="what-changes-for-searchers"></a>What Changes for Searchers<a class="hash-link" href="#what-changes-for-searchers" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="blockbuilding-algorithm"></a>Blockbuilding Algorithm<a class="hash-link" href="#blockbuilding-algorithm" title="Direct link to heading">#</a></h3><p>The Flashbots builder will use a new algorithm designed to produce the most profitable block possible. This design introduces some important changes for searchers to be aware of:</p><ul><li>Instead of ranking and including bundles based off of effective gas price the algorithm now optimizes for overall block profit.</li><li>Top-of-block execution is no longer a guarantee.</li><li>Bundle ordering by effective gas price is no longer a guarantee.</li><li>Other transactions (e.g. from the mempool) may land between bundles (not between transactions in bundles, but between two different bundles).<br><em>For example:</em><br>
If you have a bundle comprised of transactions <code>[B1, B2]</code><br>
and someone else has a bundle comprised of transactions <code>[C1, C2]</code><br>
and there are transactions in the mempool <code>[t1, t2, ...]</code>,<br>
then the block may be built such that:<br><code>BLOCK_TXS = [..., B1, B2, t1, t2, C1, C2, ...]</code>.<br>
The bundles still remain atomic, but the difference from the PoW architecture is that not all bundles will be ordered next to each other, and bundles are not necessarily placed at the top of the block.
</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="mev-blocks-api"></a>MEV-Blocks API<a class="hash-link" href="#mev-blocks-api" title="Direct link to heading">#</a></h3><p>The data processed by the <a href="https://blocks.flashbots.net/" target="_blank" rel="noopener noreferrer">Blocks API</a> will see some changes on the backend, but we will keep the existing API online through the merge by porting data from the Flashbots builder to the original API. This is done to maintain backwards compatibility with client libraries. We plan to expose a new <code>/v2</code> API alongside the original, which will include information specific to PoS Ethereum â€” we&#x27;ll release more details on this soon via <a href="https://twitter.com/zeroXbrock" target="_blank" rel="noopener noreferrer">Twitter</a> and our <a href="https://discord.gg/fR3dNrQh" target="_blank" rel="noopener noreferrer">Discord server</a>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="better-support"></a>Better Support<a class="hash-link" href="#better-support" title="Direct link to heading">#</a></h3><p>First, we&#x27;ve created a new forum for searchers: The <a href="https://collective.flashbots.net/c/searchers/12" target="_blank" rel="noopener noreferrer">Searchers Self-Support Forum</a>. This was created to facilitate long-form discussions about searching, and to help searchers find answers to common issues more quickly. We&#x27;ve also added new content in our <a href="https://docs.flashbots.net/flashbots-auction/searchers/faq" target="_blank" rel="noopener noreferrer">FAQ</a> related to searching post-merge. Lastly, we&#x27;ve created a new email account for searchers to report problems, ask questions, and suggest new ideas: <a href="mailto:searchersupport@flashbots.net" target="_blank" rel="noopener noreferrer">searchersupport@flashbots.net</a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="conclusion"></a>Conclusion<a class="hash-link" href="#conclusion" title="Direct link to heading">#</a></h2><p>In this post, we covered the basics of proposer/builder separation in PoS Ethereum, and how that affects searchers. We discussed the blockspace auction, which PoW searchers are already familiar with, and the new slot auction in which builders compete. We also explain some considerations for choosing builders, and how Flashbots will make the transition to searching on PoS Ethereum effortless.</p><p>Answers to common questions related to searching after the merge can be found in our <a href="https://docs.flashbots.net/flashbots-auction/searchers/faq" target="_blank" rel="noopener noreferrer">FAQ</a> (latest questions at the end). We also invite you to join the discussion and share your questions and ideas in the <strong>new <a href="https://collective.flashbots.net/c/searchers/12" target="_blank" rel="noopener noreferrer">Searchers Self-Support Forum</a></strong>.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/writings/flashbots-protect-merge-and-beyond"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Flashbots Protect -- The Merge &amp; Beyond Â»</div></a></div></nav></main><div class="col col--2 TOC_1KIS"><div class="tableOfContents_rbnR thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#key-takeaways" class="table-of-contents__link">Key Takeaways</a></li><li><a href="#proposerbuilder-separation-pbs" class="table-of-contents__link">Proposer/Builder Separation (PBS)</a></li><li><a href="#bidding-for-inclusion" class="table-of-contents__link">Bidding for Inclusion</a></li><li><a href="#how-to-choose-a-good-builder" class="table-of-contents__link">How to Choose a Good Builder</a></li><li><a href="#what-stays-the-same" class="table-of-contents__link">What Stays the Same</a></li><li><a href="#what-changes-for-searchers" class="table-of-contents__link">What Changes for Searchers</a><ul><li><a href="#blockbuilding-algorithm" class="table-of-contents__link">Blockbuilding Algorithm</a></li><li><a href="#mev-blocks-api" class="table-of-contents__link">MEV-Blocks API</a></li><li><a href="#better-support" class="table-of-contents__link">Better Support</a></li></ul></li><li><a href="#conclusion" class="table-of-contents__link">Conclusion</a></li></ul></div></div></div></div></div><footer class="footer"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Flashbots Â© 2022</div></div></div></footer></div>
<script src="/assets/js/runtime~main.cfd8f5bd.js"></script>
<script src="/assets/js/main.10a441de.js"></script>
</body>
</html>